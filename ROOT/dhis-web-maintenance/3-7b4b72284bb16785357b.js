webpackJsonp([3,4],{1340:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return!!("edit"!==e&&"clone"!==e||this.getCurrentUser().canUpdate(this.getModelDefinitionByName(this.props.params.modelType)))}function c(e){return!("delete"===e&&!this.getCurrentUser().canDelete(this.getModelDefinitionByName(this.props.params.modelType)))}function l(e){var t=G.a.for(e),n=["name","shortName"];switch(t.indexOf("description")>=0&&n.push("description"),e){case"dataElement":return n.concat(["formName"]);case"organisationUnitLevel":return["name"]}return n}var u=n(0),p=n.n(u),d=n(15),m=n.n(d),f=n(302),h=n.n(f),g=n(296),y=n(504),b=n(1404),v=n(514),_=n(299),T=n(207),S=n(503),E=n(518),w=n(55),O=n.n(w),x=n(100),P=n(1405),C=n(1407),j=n(1406),R=n(82),D=n.n(R),A=n(1358),q=n(1429),k=n(516),N=n(517),L=n(1360),V=n(515),U=n(1408),I=n(501),B=n(1410),F=n(67),W=n(150),G=n(295),M=n(14),H=(n.n(M),n(1374)),$=n(1354),z=n(69),K=n(208),Y=n(154),J=(n(1409),function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}()),Q=function(t){function n(){return r(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return o(n,t),J(n,[{key:"componentDidMount",value:function(){var t=this;this.subscription=M.Observable.fromEvent(e,"scroll").debounceTime(200).map(function(){return document.querySelector("body").scrollTop}).subscribe(function(){return t.forceUpdate()})}},{key:"componentWillUnmount",value:function(){this.subscription&&this.subscription.unsubscribe()}},{key:"render",value:function(){var e={maxWidth:500,minWidth:300,marginTop:document.querySelector("body").scrollTop};return p.a.createElement("div",{style:this.props.style},p.a.createElement(O.a,{zDepth:1,rounded:!1,style:e},p.a.createElement(b.a,{source:this.props.detailsObject,showDetailBox:!!this.props.detailsObject,onClose:this.props.onClose})))}}]),n}(u.Component),X=p.a.createClass({displayName:"List",propTypes:{params:p.a.PropTypes.shape({modelType:p.a.PropTypes.string.isRequired})},mixins:[E.a,x.a,A.a],getInitialState:function(){return{dataRows:[],pager:{total:0},isLoading:!0,detailsObject:null,sharing:{model:null,open:!1},translation:{model:null,open:!1},orgunitassignment:{model:null,open:!1},dataElementOperand:{model:null,open:!1},predictorDialog:{open:!1}}},componentWillMount:function(){var e=this,t=T.a.subscribe(function(t){h()(t.list)&&e.setState({dataRows:t.list,pager:t.pager,tableColumns:t.tableColumns,filters:t.filters,isLoading:!1})}),n=_.a.subscribe(function(t){e.setState({detailsObject:t})}),a=k.a.subscribe(function(t){e.setState(function(e){return{sharing:t,dataRows:e.dataRows.map(function(e){return e.id===t.model.id?Object.assign(e,{publicAccess:t.model.publicAccess}):e})}})}),r=N.a.subscribe(function(t){e.setState({translation:t})}),i=V.a.subscribe(function(t){e.setState({dataElementOperand:t})}),o=I.a.subscribe(function(t){e.setState({predictorDialog:t})});this.registerDisposable(t),this.registerDisposable(n),this.registerDisposable(a),this.registerDisposable(r),this.registerDisposable(i),this.registerDisposable(o)},componentWillReceiveProps:function(e){this.props.params.modelType!==e.params.modelType&&this.setState({isLoading:!0,translation:Object.assign({},this.state.translation,{open:!1})})},_translationSaved:function(){F.a.show({message:"translation_saved",translate:!0})},_translationError:function(e){m.a.error(e),F.a.show({message:"translation_save_error",action:"ok",translate:!0})},isContextActionAllowed:function(e,t){if(!e||!e.access)return!1;if("categoryOptionCombo"===e.modelDefinition.name)return"edit"===t?e.access.write:"details"===t&&e.access.read;if(e.access.hasOwnProperty(t))return e.access[t];if("runNow"===t&&"predictor"===e.modelDefinition.name)return this.context.d2.currentUser.authorities.has("F_PREDICTOR_RUN");switch(t){case"edit":return e.access.write;case"clone":return"dataSet"!==e.modelDefinition.name&&e.access.write;case"translate":return e.access.read&&e.modelDefinition.identifiableObject;case"details":return e.access.read;case"share":return!0===e.modelDefinition.isShareable&&e.access.write;case"compulsoryDataElements":case"sectionForm":case"dataEntryForm":return"dataSet"===e.modelDefinition.name&&e.access.write;case"pdfDataSetForm":return"dataSet"===e.modelDefinition.name&&e.access.read;case"runNow":case"preview":return"pushAnalysis"===e.modelDefinition.name&&e.access.write;default:return!0}},searchListByName:function(e){var t=this,n=e.subscribe(function(e){t.setState({isLoading:!0}),S.a.searchByName({modelType:t.props.params.modelType,searchString:e}).subscribe(function(){},function(e){return m.a.error(e)})});this.registerDisposable(n)},renderFilters:function(){var e=this,t=function(t){return function(n){e.setState({isLoading:!0}),S.a.setFilterValue({filterField:t,filterValue:n.target.value,modelType:e.props.params.modelType})}},a={inset:{},box:{display:"inline-block",marginRight:16,width:256}};return p.a.createElement("div",{style:a.inset},p.a.createElement(C.a,{searchObserverHandler:this.searchListByName}),n.i(Y.c)(this.props.params.modelType).map(function(n,r){var i=e.context.d2.models[e.props.params.modelType],o=i.modelProperties.hasOwnProperty(n)&&i.modelProperties[n].hasOwnProperty("constants"),s=o&&i.modelProperties[n].constants.map(function(e){return{text:e,value:e}}),c=e.context.d2.models.hasOwnProperty(n)?n:e.props.params.modelType+"."+n;return p.a.createElement("div",{key:n,style:a.box},o?p.a.createElement(z.a,{labelText:e.getTranslation(n),options:s,onChange:t(n),value:e.state.filters?e.state.filters[n]:null,translateOptions:"periodType"!==n}):p.a.createElement(K.a,{labelText:e.getTranslation(n),referenceType:c,onChange:t(n),value:e.state.filters?e.state.filters[n]:null,quickAddLink:!1,preventAutoDefault:!0,styles:{display:"relative"},limit:1,top:-15}))}))},render:function(){var e=this,t=n.i(H.a)(this.state.pager),r={hasNextPage:function(){return Boolean(e.state.pager.hasNextPage)&&e.state.pager.hasNextPage()},hasPreviousPage:function(){return Boolean(e.state.pager.hasPreviousPage)&&e.state.pager.hasPreviousPage()},onNextPageClick:function(){e.setState({isLoading:!0}),S.a.getNextPage()},onPreviousPageClick:function(){e.setState({isLoading:!0}),S.a.getPreviousPage()},total:this.state.pager.total,currentlyShown:t},i=Object.keys(v.a).filter(s,this).filter(c,this).filter(function(t){return"share"!==t||e.context.d2.models[e.props.params.modelType]&&e.context.d2.models[e.props.params.modelType].isShareable}).reduce(function(e,t){return e[t]=v.a[t],e},{}),o={dataTableWrap:{display:"flex",flexDirection:"column",flex:2},detailsBoxWrap:{flex:1,marginLeft:"1rem",marginRight:"1rem",opacity:1,flexGrow:0},listDetailsWrap:{flex:1,display:"flex",flexOrientation:"row"},filterWrap:{clear:"both",minHeight:80}},u={clone:"content_copy",sharing:"share",sectionForm:"assignment_turned_in",dataEntryForm:"assignment",pdfDataSetForm:"picture_as_pdf",compulsoryDataElements:"border_color",runNow:"queue_play_next",preview:"dashboard"},d=function(t){return e.state.tableColumns.reduce(function(e,n){if(n.includes("___")){var r=n.substr(0,n.indexOf("___")),i=n.substr(n.indexOf("___")+3);Object.assign(e,a({},n,t&&t[r]&&t[r][i]||""))}return e},t),t},m=function(t){return t.categoryCombo&&t.categoryCombo.displayName&&"default"===t.categoryCombo.displayName&&t.categoryCombo___displayName===t.categoryCombo.displayName&&(t.categoryCombo.displayName=t.categoryCombo___displayName=e.getTranslation("none")),t},f=function(t){var n={organisationUnit:["level"],dataSet:["formType"]},a=function(e,t){return!(n.hasOwnProperty(e)&&n[e].includes(t))};return t.noMoreGottaTranslateCauseIsDone?t:e.state.tableColumns.reduce(function(n,r){return a(t.modelDefinition.name,r)&&t&&t.modelDefinition&&t.modelDefinition.modelProperties[r]&&t.modelDefinition.modelProperties[r].constants&&(t.noMoreGottaTranslateCauseIsDone=!0,t[r]&&(n[r]=e.getTranslation(t[r].toLowerCase()))),n},t)},h=function(e){e.access.write?i.edit(e):F.a.show({message:"you_do_not_have_permissions_to_edit_this_object",translate:!0,action:"dismiss"})};return p.a.createElement("div",null,p.a.createElement("div",null,p.a.createElement(W.a,null,this.getTranslation(D()(this.props.params.modelType)+"_management"),p.a.createElement($.a,{schema:this.props.params.modelType})),p.a.createElement(P.a,{modelType:this.props.params.modelType,groupName:this.props.params.groupName})),p.a.createElement("div",{style:o.filterWrap},p.a.createElement("div",{style:{float:"right"}},p.a.createElement(y.a,r)),this.renderFilters()),p.a.createElement(j.a,{loadingText:["Loading",this.props.params.modelType,"list..."].join(" "),isLoading:this.state.isLoading}),this.state.isLoading?p.a.createElement("div",null,"Loading..."):p.a.createElement("div",{style:o.listDetailsWrap},p.a.createElement("div",{style:o.dataTableWrap},this.state.dataRows&&this.state.dataRows.length?p.a.createElement(g.a,{rows:this.state.dataRows.map(d).map(m).map(f),columns:this.state.tableColumns,contextMenuActions:i,contextMenuIcons:u,primaryAction:h,isContextActionAllowed:this.isContextActionAllowed}):p.a.createElement("div",null,this.getTranslation("no_results_found"))),this.state.detailsObject?p.a.createElement(Q,{style:o.detailsBoxWrap,detailsObject:this.state.detailsObject,onClose:S.a.hideDetailsBox}):null),this.state.dataRows&&this.state.dataRows.length?p.a.createElement("div",{style:{marginTop:"-2rem",paddingBottom:"0.5rem"}},p.a.createElement(y.a,r)):null,this.state.sharing.model?p.a.createElement(q.a,{id:this.state.sharing.model.id,type:this.props.params.modelType,open:this.state.sharing.model&&this.state.sharing.open,onRequestClose:this._closeSharingDialog,bodyStyle:{minHeight:"400px"}}):null,this.state.translation.model?p.a.createElement(L.a,{objectToTranslate:this.state.translation.model,objectTypeToTranslate:this.state.translation.model&&this.state.translation.model.modelDefinition,open:this.state.translation.open,onTranslationSaved:this._translationSaved,onTranslationError:this._translationError,onRequestClose:this._closeTranslationDialog,fieldsToTranslate:l(this.props.params.modelType)}):null,p.a.createElement(U.a,{model:this.state.dataElementOperand.model,dataElementOperands:this.state.dataElementOperand.dataElementOperands,open:this.state.dataElementOperand.open,onRequestClose:this._closeDataElementOperandDialog}),this.state.predictorDialog&&p.a.createElement(B.a,null))},_closeTranslationDialog:function(){N.a.setState(Object.assign({},N.a.state,{open:!1}))},_closeSharingDialog:function(e){var t=e?Object.assign(k.a.state.model,{publicAccess:e.publicAccess}):k.a.state.model;k.a.setState(Object.assign({},k.a.state,{model:t,open:!1}))},_closeDataElementOperandDialog:function(){V.a.setState(Object.assign({},V.a.state,{open:!1}))}});t.default=X}.call(t,n(28))},1347:function(e,t,n){"use strict";function a(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function r(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(r,i){try{var o=t[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}return a("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=n(0),l=n.n(c),u=n(1340),p=n(56),d=n(13),m=(n.n(d),n(503)),f=n(15),h=n.n(f),g=n(216),y=n.n(g),b=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},v=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),_=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),v(t,[{key:"componentDidMount",value:function(){var e=this;this.subscription=p.b.filter(function(e){return"organisationUnit"===e.sideBar.currentSubSection}).map(function(e){return{selectedOrganisationUnit:e.selectedOrganisationUnit,userOrganisationUnitIds:e.userOrganisationUnits.toArray().map(function(e){return e.id})}}).filter(function(e){return e.selectedOrganisationUnit}).distinctUntilChanged(null,function(e){return e.selectedOrganisationUnit}).subscribe(function(){var t=r(regeneratorRuntime.mark(function t(a){var r,i,o=a.selectedOrganisationUnit,s=a.userOrganisationUnitIds;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.i(d.getInstance)();case 2:if(r=e.sent,o.id){e.next=5;break}return e.abrupt("return",m.a.setListSource(y.a.create(r.models.organisationUnit)));case 5:return i=r.models.organisationUnit.filter().on("name").notEqual("default"),e.next=8,i.filter().on("name").notEqual("default").filter().on("parent.id").equals(o.id).list({fields:m.b});case 8:i=e.sent,s.indexOf(o.id)>=0&&i.add(o),m.a.setListSource(i);case 11:case"end":return e.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}(),function(e){return h.a.error(e)})}},{key:"componentWillUnmount",value:function(){this.subscription&&this.subscription.unsubscribe&&this.subscription.unsubscribe()}},{key:"render",value:function(){var e=this.props,t=e.params,n=a(e,["params"]);return l.a.createElement(u.default,b({},n,{params:Object.assign({modelType:"organisationUnit"},t)}))}}]),t}(l.a.Component);t.default=_},1354:function(e,t,n){"use strict";function a(e){var t=e.major,n=e.minor;return e.snapshot?"master":t+"."+n}function r(e,t){var a=new Map([["objectType",t]]),r=new Map([["objectType",n.i(p.camelCaseToUnderscores)(t)]]),o=Object.keys(u.a).find(function(t){var n=i(t,a);return new RegExp(n).test(e)});return o&&u.a[o]?i(u.a[o],r):""}function i(e,t){var n=/\$\{(.+?)\}/g;return e.replace(n,function(e,n,a){return t.has(n)&&t.get(n)?t.get(n):".+?"})}function o(e,t){var n=e.schema,i=t.d2,o=window.location.hash.replace(/^#/,"").replace(/\?.+?$/,""),s="https://ci.dhis2.org/docs/"+a(i.system.version),l=r(o,n);return l?React.createElement(c.a,{href:""+s+l,target:"_blank",rel:"noopener noreferrer",tooltip:i.i18n.getTranslation("open_user_guide"),tooltipPosition:"bottom-center",iconClassName:"material-icons",iconStyle:{top:-2}},"help_outline"):null}t.a=o;var s=n(46),c=n.n(s),l=n(1355),u=n.n(l),p=n(293);n.n(p);o.contextTypes={d2:React.PropTypes.object}},1355:function(e,t){e.exports={"/edit/categorySection/categoryOptionGroupSet":"/en/user/html/manage_category.html#create_category_option_group_set","/edit/categorySection/categoryOptionGroup":"/en/user/html/manage_category.html#create_category_option_group","/edit/categorySection/categoryOptionCombo":"/en/user/html/manage_category.html#assign_code_category_option_combo","/edit/categorySection/categoryOption":"/en/user/html/manage_category.html#create_category_option","/edit/categorySection/categoryCombo":"/en/user/html/manage_category.html#create_category_combination","/edit/categorySection/category":"/en/user/html/manage_category.html#create_category","/list/categorySection":"/en/user/html/manage_category.html","/edit/dataElementSection/dataElementGroupSet":"/en/user/html/manage_data_element.html#create_data_element_group_set","/edit/dataElementSection/dataElementGroup":"/en/user/html/manage_data_element.html#create_data_element_group","/edit/dataElementSection/dataElement":"/en/user/html/manage_data_element.html#create_data_element","/list/dataElementSection":"/en/user/html/manage_data_element.html","/edit/dataSetSection/dataSet":"/en/user/html/manage_data_set.html#create_data_set","/list/dataSetSection/dataSet":"/en/user/html/manage_data_set.html","/edit/indicatorSection/indicatorGroupSet":"/en/user/html/manage_indicator.html#create_indicator_group_set","/edit/indicatorSection/indicatorGroup":"/en/user/html/manage_indicator.html#create_indicator_group","/edit/indicatorSection/indicatorType":"/en/user/html/manage_indicator.html#create_indicator_type","/edit/indicatorSection/indicator":"/en/user/html/manage_indicator.html#create_indicator","/list/indicatorSection":"/en/user/html/manage_indicator.html","/edit/organisationUnitSection/organisationUnitGroupSet":"/en/user/html/manage_organisation_unit.html#create_organisation_unit_group_set","/edit/organisationUnitSection/organisationUnitGroup":"/en/user/html/manage_organisation_unit.html#create_organisation_unit_group","/edit/organisationUnitSection/organisationUnitLevel":"/en/user/html/manage_organisation_unit.html#name_organisation_unit_level","/edit/organisationUnitSection/organisationUnit":"/en/user/html/manage_organisation_unit.html#create_organisation_unit","/list/organisationUnitSection":"/en/user/html/manage_organisation_unit.html","/edit/programSection/trackedEntityAttributeGroup":"/en/user/html/manage_program_metadata.html#create_tracked_entity_attribute_group","/edit/programSection/trackedEntityAttribute":"/en/user/html/manage_program_metadata.html#create_tracked_entity_attribute","/edit/programSection/relationshipType":"/en/user/html/manage_program_metadata.html#create_relationship_type","/edit/programSection/trackedEntity":"/en/user/html/manage_program_metadata.html#create_tracked_entity","/list/programSection":"/en/user/html/manage_program_metadata.html","/edit/validationSection/validationNotificationTemplate":"/en/user/html/manage_validation_rule.html#create_validation_notification","/edit/validationSection/validationRuleGroup":"/en/user/html/manage_validation_rule.html#create_validation_rule_group","/edit/validationSection/validationRule":"/en/user/html/manage_validation_rule.html#create_validation_rule","/list/validationSection":"/en/user/html/manage_validation_rule.html","/edit/otherSection/legendSet":"/en/user/html/manage_legend.html#create_legend","/list/otherSection/legendSet":"/en/user/html/manage_legend.html","/edit/otherSection/pushAnalysis":"/en/user/html/manage_push_report.html#create_push_report","/list/otherSection/pushAnalysis":"/en/user/html/manage_push_report.html","/edit/otherSection/externalMapLayer":"/en/user/html/manage_external_maplayer.html#create_external_map_layer","/list/otherSection/externalMapLayer":"/en/user/html/manage_external_maplayer.html","/edit/otherSection/${objectType}":"/en/user/html/manage_${objectType}.html#create_${objectType}","/list/otherSection/${objectType}":"/en/user/html/manage_${objectType}.html"}},1358:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i={contextTypes:{d2:r.a.PropTypes.object.isRequired},getCurrentUser:function(){return this.context.d2.currentUser},getModelDefinitionByName:function(e){return this.context.d2.models[e]}};t.a=i},1359:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(118),o=n.n(i),s=n(84),c=n.n(s),l=n(100),u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.a=r.a.createClass({displayName:"LocaleSelector.component",propTypes:{value:r.a.PropTypes.string,locales:r.a.PropTypes.arrayOf(r.a.PropTypes.shape({name:r.a.PropTypes.string.isRequired,locale:r.a.PropTypes.string.isRequired})).isRequired,onChange:r.a.PropTypes.func.isRequired},mixins:[l.a],render:function(){var e=[{payload:"",text:""}].concat(this.props.locales).map(function(e,t){return r.a.createElement(c.a,{key:t,primaryText:e.name,value:e.locale})});return r.a.createElement(o.a,u({fullWidth:!0},this.props,{value:this.state&&this.state.locale,hintText:this.getTranslation("select_locale"),onChange:this._localeChange}),e)},_localeChange:function(e,t,n){this.setState({locale:n}),this.props.onChange(n,e)}})},1360:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var o=n(13),s=(n.n(o),n(292)),c=n.n(s),l=n(0),u=n.n(l),p=n(1361),d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},m=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();o.config.i18n.strings.add("close"),o.config.i18n.strings.add("sharing_settings");var f=function(e){function t(e,i){a(this,t);var o=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,i));return o.i18n=i.d2.i18n,o.state={TranslationForm:n.i(p.a)(o.props.objectToTranslate)},o.translationSaved=o.translationSaved.bind(o),o.translationError=o.translationError.bind(o),o.closeSharingDialog=o.closeSharingDialog.bind(o),o}return i(t,e),m(t,[{key:"render",value:function(){return u.a.createElement(c.a,d({title:this.i18n.getTranslation("translation_dialog_title"),autoDetectWindowHeight:!0,autoScrollBodyContent:!0},this.props),u.a.createElement(this.state.TranslationForm,{onTranslationSaved:this.translationSaved,onTranslationError:this.translationError,onCancel:this.closeSharingDialog,fieldsToTranslate:this.props.fieldsToTranslate}))}},{key:"componentWillReceiveProps",value:function(e){e.objectToTranslate&&this.setState({TranslationForm:n.i(p.a)(e.objectToTranslate)})}},{key:"closeSharingDialog",value:function(){this.props.onRequestClose()}},{key:"translationSaved",value:function(){this.props.onTranslationSaved(),this.closeSharingDialog()}},{key:"translationError",value:function(){this.props.onTranslationError()}}]),t}(l.Component);t.a=f,f.propTypes={objectToTranslate:u.a.PropTypes.shape({id:u.a.PropTypes.string.isRequired}).isRequired,onTranslationSaved:u.a.PropTypes.func.isRequired,onTranslationError:u.a.PropTypes.func.isRequired,open:u.a.PropTypes.bool,onRequestClose:u.a.PropTypes.func.isRequired,fieldsToTranslate:u.a.PropTypes.array},f.contextTypes={d2:l.PropTypes.object}},1361:function(e,t,n){"use strict";function a(e){var t=b.a.create();return n.i(p.a)(e).subscribe(function(e){t.setState(e)}),y.Observable.combineLatest(n.i(p.b)(),t,function(){for(var n=arguments.length,a=Array(n),r=0;r<n;r++)a[r]=arguments[r];return Object.assign.apply(Object,[{objectToTranslate:e,setTranslations:function(e){t.setState({translations:e})}}].concat(a))})}function r(e){return n.i(f.a)(a(e),_)}t.a=r;var i=n(0),o=n.n(i),s=n(45),c=n.n(s),l=n(100),u=n(1359),p=n(1362),d=n(82),m=n.n(d),f=n(201),h=n(116),g=n.n(h),y=n(14),b=(n.n(y),n(23)),v=n(83),_=o.a.createClass({displayName:"TranslationForm",propTypes:{onTranslationSaved:o.a.PropTypes.func.isRequired,onTranslationError:o.a.PropTypes.func.isRequired,objectToTranslate:o.a.PropTypes.shape({id:o.a.PropTypes.string.isRequired}),fieldsToTranslate:o.a.PropTypes.arrayOf(o.a.PropTypes.string)},mixins:[l.a],getInitialState:function(){return{loading:!0,translations:{},translationValues:{},currentSelectedLocale:""}},getDefaultProps:function(){return{fieldsToTranslate:["name","shortName","description"]}},getLoadingdataElement:function(){return o.a.createElement("div",{style:{textAlign:"center"}},o.a.createElement(v.a,{mode:"indeterminate"}))},renderFieldsToTranslate:function(){var e=this;return this.props.fieldsToTranslate.filter(function(e){return e}).map(function(t){return o.a.createElement("div",{key:t},o.a.createElement(c.a,{floatingLabelText:e.getTranslation(m()(t)),value:e.getTranslationValueFor(t),fullWidth:!0,onChange:e._setValue.bind(e,t)}),o.a.createElement("div",null,e.props.objectToTranslate[t]))})},renderForm:function(){return o.a.createElement("div",null,this.renderFieldsToTranslate(),o.a.createElement(g.a,{label:this.getTranslation("save"),primary:!0,onClick:this._saveTranslations}),o.a.createElement(g.a,{style:{marginLeft:"1rem"},label:this.getTranslation("cancel"),onClick:this.props.onCancel}))},renderHelpText:function(){return o.a.createElement("div",null,o.a.createElement("p",null,this.getTranslation("select_a_locale_to_enter_translations_for_that_language")))},render:function(){return this.props.locales||this.props.translations?o.a.createElement("div",{style:{minHeight:250}},o.a.createElement(u.a,{locales:this.props.locales,onChange:this.setCurrentLocale}),Boolean(this.state.currentSelectedLocale)?this.renderForm():this.renderHelpText()):this.getLoadingdataElement()},getTranslationValueFor:function(e){var t=this,n=this.props.translations.find(function(n){return n.locale===t.state.currentSelectedLocale&&n.property.toLowerCase()===m()(e)});if(n)return n.value},setCurrentLocale:function(e){this.setState({currentSelectedLocale:e})},_setValue:function(e,t){var n=this,a=[].concat(this.props.translations),r=a.find(function(t){return t.locale===n.state.currentSelectedLocale&&t.property.toLowerCase()===m()(e)});r?t.target.value?r.value=t.target.value:a=a.filter(function(e){return e!==r}):(r={property:m()(e).toUpperCase(),locale:this.state.currentSelectedLocale,value:t.target.value},a.push(r)),this.props.setTranslations(a)},_saveTranslations:function(){n.i(p.c)(this.props.objectToTranslate,this.props.translations).subscribe(this.props.onTranslationSaved,this.props.onTranslationError)}})},1362:function(e,t,n){"use strict";function a(){return a.localePromise||(a.localePromise=n.i(s.getInstance)().then(function(e){return e.Api.getApi().get("locales/db")}).then(function(e){return{locales:e}})),c.Observable.fromPromise(a.localePromise)}function r(e){return e.href?e.href:e.modelDefinition.apiEndpoint+"/"+e.id}function i(e){return c.Observable.of(e).flatMap(function(e){var t=e.modelDefinition;return t||t.name?n.i(s.getInstance)().then(function(t){return t.Api.getApi().get(r(e)+"/translations")}):Promise.reject(new Error("Can not find modelDefinition for "+e.id))})}t.b=a,t.a=i,n.d(t,"c",function(){return u});var o=n(37),s=n(13),c=(n.n(s),n(14)),l=(n.n(c),function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()),u=o.a.create("saveTranslations");u.subscribe(function(e){var t=l(e.data,2),a=t[0],i=t[1],o=e.complete,c=e.error,u=r(a)+"/translations";n.i(s.getInstance)().then(function(e){e.Api.getApi().update(u,{translations:i},{dataType:"text"}).then(o).catch(c)})})},1369:function(e,t,n){"use strict";function a(e){switch(e){case"user":return"person";case"userGroup":return"group";case"external":return"public";case"public":return"business";default:return"person"}}var r=n(0),i=n.n(r),o=n(51),s=n.n(o),c=n(46),l=n.n(c),u=n(1375),p={ruleView:{fontWeight:"400",display:"flex",flexDirection:"row",justifyContent:"space-between",alignItems:"center",padding:"4px 8px"},ruleDescription:{display:"flex",flexDirection:"column",flex:1,paddingLeft:16}},d=function(e){var t=e.accessType,n=e.primaryText,r=e.secondaryText,o=e.accessOptions,c=e.onChange,d=e.onRemove,m=e.disabled,f=e.disableWritePermission,h=e.disableNoAccess;return i.a.createElement("div",{style:p.ruleView},i.a.createElement(s.a,{className:"material-icons"},a(t)),i.a.createElement("div",{style:p.ruleDescription},i.a.createElement("div",null,n),i.a.createElement("div",{style:{color:"#818181",paddingTop:4}},r||" ")),i.a.createElement(u.a,{disableWritePermission:f,disableNoAccess:h,accessOptions:o,onChange:c,disabled:m}),i.a.createElement(l.a,{disabled:!d,iconStyle:{color:"#bbbbbb"},iconClassName:"material-icons",onClick:d||function(){}},"clear"))};d.propTypes={accessType:r.PropTypes.oneOf(["user","userGroup","external","public"]).isRequired,primaryText:r.PropTypes.string.isRequired,accessOptions:r.PropTypes.object.isRequired,secondaryText:r.PropTypes.string,onChange:r.PropTypes.func,onRemove:r.PropTypes.func,disabled:r.PropTypes.bool,disableWritePermission:r.PropTypes.bool,disableNoAccess:r.PropTypes.bool},t.a=d},1374:function(e,t,n){"use strict";function a(e){var t=e.query&&e.query.pageSize||50,n=e.total,a=e.pageCount,r=e.page,i=n-(n-(a-(a-r))*t),o=1+i-t,s=i;return o+" - "+(s>n?n:s)}t.a=a},1375:function(e,t,n){"use strict";function a(e){return e.canView?e.canEdit?"create":"remove_red_eye":"not_interested"}function r(e,t,n,a,r){return!r&&o.a.createElement(u.a,{insetChildren:!0,value:{canView:t,canEdit:n},primaryText:e,leftIcon:o.a.createElement(c.a,{className:"material-icons"},a?"done":"")})}var i=n(0),o=n.n(i),s=n(51),c=n.n(s),l=n(90),u=n.n(l),p=n(527),d=n.n(p),m=n(46),f=n.n(m),h=n(13);n.n(h);h.config.i18n.strings.add("can_edit_and_view"),h.config.i18n.strings.add("can_view_only"),h.config.i18n.strings.add("no_access");var g=function(e,t){var n=e.accessOptions,i=e.onChange,s=e.disabled,c=e.disableWritePermission,l=e.disableNoAccess;return o.a.createElement(d.a,{anchorOrigin:{vertical:"bottom",horizontal:"right"},touchTapCloseDelay:1,menuStyle:{width:"200px"},onChange:function(e,t){return i(t)},iconButtonElement:o.a.createElement(f.a,{disabled:s,iconClassName:"material-icons"},a(n))},r(t.d2.i18n.getTranslation("can_edit_and_view"),!0,!0,n.canEdit,c),r(t.d2.i18n.getTranslation("can_view_only"),!0,!1,n.canView&&!n.canEdit),r(t.d2.i18n.getTranslation("no_access"),!1,!1,!n.canView&&!n.canEdit,l))};g.propTypes={accessOptions:i.PropTypes.shape({canView:i.PropTypes.bool.isRequired,canEdit:i.PropTypes.bool}).isRequired,onChange:i.PropTypes.func.isRequired,disabled:i.PropTypes.bool,disableWritePermission:i.PropTypes.bool,disableNoAccess:i.PropTypes.bool},g.contextTypes={d2:i.PropTypes.object.isRequired},t.a=g},1404:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(155),o=n.n(i),s=n(294),c=n.n(s),l=n(100),u=n(82),p=n.n(u);t.a=r.a.createClass({displayName:"DetailsBox.component",propTypes:{fields:r.a.PropTypes.array,showDetailBox:r.a.PropTypes.bool,source:r.a.PropTypes.object,onClose:r.a.PropTypes.func},mixins:[l.a],getDefaultProps:function(){return{fields:["name","shortName","code","displayDescription","created","lastUpdated","id","href"],showDetailBox:!1,onClose:function(){}}},getDetailBoxContent:function(){var e=this;return this.props.source?this.props.fields.filter(function(t){return e.props.source[t]}).map(function(t){var n=e.getValueToRender(t,e.props.source[t]);return r.a.createElement("div",{key:t,className:"detail-field"},r.a.createElement("div",{className:"detail-field__label detail-field__"+t+"-label"},e.getTranslation(p()(t))),r.a.createElement("div",{className:"detail-field__value detail-field__"+t},n))}):r.a.createElement("div",{className:"detail-box__status"},"Loading details...")},getValueToRender:function(e,t){if(Array.isArray(t)&&t.length){var n=t.map(function(e){return e.displayName?e.displayName:e.name}).filter(function(e){return e});return r.a.createElement("ul",null,n.map(function(e){return r.a.createElement("li",{key:e},e)}))}return"created"===e||"lastUpdated"===e?function(e){var t=new Date(e).toString();return"Invalid Date"===t?e:t}(t):"href"===e?r.a.createElement("a",{style:{wordBreak:"break-all"},href:t+".json",target:"_blank"},t):t},render:function(){var e=o()("details-box");return!1===this.props.showDetailBox?null:r.a.createElement("div",{className:e},r.a.createElement(c.a,{className:"details-box__close-button material-icons",onClick:this.props.onClose},"close"),r.a.createElement("div",null,this.getDetailBoxContent()))}})},1405:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(297),o=n.n(i),s=n(294),c=n.n(s),l=n(1358),u=n(101),p=r.a.createClass({displayName:"ListActionBar",propTypes:{modelType:r.a.PropTypes.string.isRequired,groupName:r.a.PropTypes.string.isRequired},mixins:[l.a],_addClick:function(){n.i(u.c)("/edit/"+this.props.groupName+"/"+this.props.modelType+"/add")},render:function(){var e={textAlign:"right",marginTop:"1rem",bottom:"1.5rem",right:"1.5rem",position:"fixed",zIndex:10},t=this.getModelDefinitionByName(this.props.modelType);return this.getCurrentUser().canCreate(t)?r.a.createElement("div",{style:e},r.a.createElement(o.a,{onClick:this._addClick},r.a.createElement(c.a,{className:"material-icons"},"add"))):null}});t.a=p},1406:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(102),o=n.n(i);t.a=r.a.createClass({displayName:"LoadingStatus.component",propTypes:{isLoading:r.a.PropTypes.bool.isRequired},getDefaultProps:function(){return{isLoading:!1}},render:function(){return this.props.isLoading?r.a.createElement(o.a,{mode:"indeterminate",style:{backgroundColor:"lightblue"}}):null}})},1407:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(1423),o=n(100),s=n(45),c=n.n(s),l=n(13),u=(n.n(l),n(56)),p=["organisationUnit"],d=r.a.createClass({displayName:"SearchBox",propTypes:{searchObserverHandler:r.a.PropTypes.func.isRequired},mixins:[i.a,o.a],getInitialState:function(){return{showSearchField:!1,value:""}},componentWillMount:function(){this.searchBoxCb=this.createEventObserver("searchBox")},componentDidMount:function(){var e=this,t=this.events.searchBox.debounceTime(400).map(function(e){return e&&e.target&&e.target.value?e.target.value:""}).distinctUntilChanged();this.props.searchObserverHandler(t),this.subscription=u.d.subscribe(function(t){return e.setState({value:"",showSearchField:!p.includes(t)})})},componentWillUnmount:function(){this.subscription&&this.subscription.unsubscribe&&this.subscription.unsubscribe()},render:function(){var e={display:"inline-block",marginRight:16,position:"relative",top:-15};return this.state.showSearchField?r.a.createElement("div",{className:"search-list-items",style:e},r.a.createElement(c.a,{className:"list-search-field",value:this.state.value,fullWidth:!1,type:"search",onChange:this._onKeyUp,floatingLabelText:""+this.getTranslation("search_by_name")})):null},_onKeyUp:function(e){this.setState({value:e.target.value}),this.searchBoxCb(e)}});t.a=d},1408:function(e,t,n){"use strict";function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(r,i){try{var o=t[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}return a("next")})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){var t={},n=this.getOwnedPropertyNames(),a=e.getCollectionChildrenPropertyNames();return Object.keys(this.modelValidations).forEach(function(r){if(n.indexOf(r)>=0&&void 0!==e.dataValues[r]&&null!==e.dataValues[r])if(-1===a.indexOf(r))t[r]=e.dataValues[r];else{if("compulsoryDataElementOperands"===r)return void(t[r]=e.dataValues[r]);t[r]=Array.from(e.dataValues[r].values()).filter(function(e){return e.id}).map(function(t){return e.modelDefinition&&"legendSet"===e.modelDefinition.name?s.call(t.modelDefinition,t):{id:t.id}})}}),t}var c=n(0),l=n.n(c),u=n(292),p=n.n(u),d=n(68),m=n.n(d),f=n(116),h=n.n(f),g=n(45),y=n.n(g),b=n(33),v=n(150),_=n(151),T=n(23),S=n(67),E=function(){function e(e,t){var n=[],a=!0,r=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(a=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);a=!0);}catch(e){r=!0,i=e}finally{try{!a&&s.return&&s.return()}finally{if(r)throw i}}return n}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),O=T.a.create(),x=T.a.create(),P=function(e){function t(e,n){var o=this;r(this,t);var c=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return c._changeFilter=function(e){c.setState({filterText:e.target.value})},c._assignItems=function(){var e=a(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.getState().concat(t),x.setState(n),e.abrupt("return",Promise.resolve(!0));case 3:case"end":return e.stop()}},e,o)}));return function(t){return e.apply(this,arguments)}}(),c._removeItems=function(e){var t=x.getState().filter(function(t){return-1===e.indexOf(t)});return x.setState(t),Promise.resolve(!0)},c._saveCollection=function(){var e=x.getState().map(function(e){return e.split(".")}).filter(function(e){return 2===e.length}).map(function(e){var t=E(e,2);return{dataElement:{id:t[0]},categoryOptionCombo:{id:t[1]}}});c.setState({isSaving:!0});s.bind(c.props.model.modelDefinition)(c.props.model),c.context.d2;c.props.model.compulsoryDataElementOperands=e,c.props.model.save().then(function(){S.a.show({message:"saved_compulsory_data_elements",translate:!0})}).catch(function(){S.a.show({message:"failed_to_save_compulsory_data_elements",action:"ok",translate:!0})}).then(function(){c.setState({isSaving:!1}),c.props.onRequestClose()})},c.state={filterText:"",isSaving:!1},c.i18n=n.d2.i18n,e.dataElementOperands&&e.model&&(O.setState(e.dataElementOperands.map(function(e){return{text:e.displayName,value:e.dataElementId+"."+e.optionComboId}})),x.setState(e.model.compulsoryDataElementOperands.filter(function(e){return e.dataElement&&e.categoryOptionCombo}).map(function(e){return e.dataElement.id+"."+e.categoryOptionCombo.id}))),c}return o(t,e),w(t,[{key:"componentWillReceiveProps",value:function(e){e.open?e.dataElementOperands&&e.model&&(O.setState(e.dataElementOperands.map(function(e){return{text:e.displayName,value:[e.dataElementId,e.optionComboId].join(".")}})),x.setState(e.model.compulsoryDataElementOperands.filter(function(e){return e.dataElement&&e.categoryOptionCombo}).map(function(e){return[e.dataElement.id,e.categoryOptionCombo.id].join(".")}))):(O.setState(void 0),x.setState([]))}},{key:"render",value:function(){var e=this.state.isSaving?this.i18n.getTranslation("saving"):this.i18n.getTranslation("save"),t=[l.a.createElement(m.a,{disabled:this.state.isSaving,style:{marginRight:"1rem"},onClick:this.props.onRequestClose,label:this.i18n.getTranslation("close")}),l.a.createElement(h.a,{labelColor:"white",disabled:this.state.isSaving,primary:!0,onClick:this._saveCollection,label:e})];return l.a.createElement(p.a,{open:this.props.open,onRequestClose:this.props.onRequestClose,autoScrollBodyContent:!0,modal:!0,actions:t,contentStyle:{maxWidth:"none",width:"95%"}},l.a.createElement("div",{style:{marginBottom:"3.5rem"}},l.a.createElement(v.a,null,this.i18n.getTranslation("edit_compulsory_data_elements")," - ",this.props.model&&this.props.model.displayName),l.a.createElement(y.a,{floatingLabelText:this.i18n.getTranslation("filter"),style:{width:"100%"},onChange:this._changeFilter}),l.a.createElement(_.a,{itemStore:O,assignedItemStore:x,onAssignItems:this._assignItems,onRemoveItems:this._removeItems,height:350,filterText:this.state.filterText})))}}]),t}(c.Component);t.a=n.i(b.a)(P)},1409:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(519),o=n(159),s=n.n(o),c=n(528),l=n.n(c),u=n(1449),p=n.n(u),d=n(529),m=n.n(d),f=n(213),h=n.n(f),g=n(72),y=n.n(g),b=n(11),v=(n.n(b),n(71)),_=y()(function(){return{}}),T=s()(function(e){var t=e.value;return!n.i(b.isString)(t)},h.a),S=s()(function(e){return!0===e.value},m()(_(l.a)))(_(p.a));n.i(i.b)(function(e){return"BOOLEAN"===e.valueType},S),n.i(i.b)(function(e){var t=e.columnName,n=e.valueType;return"formType"===t&&"CONSTANT"===n},T(function(e){var t=e.value;return r.a.createElement(v.a,null,t.toLowerCase())}))},1410:function(e,t,n){"use strict";function a(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function a(r,i){try{var o=t[r](i),s=o.value}catch(e){return void n(e)}if(!o.done)return Promise.resolve(s).then(function(e){a("next",e)},function(e){a("throw",e)});e(s)}return a("next")})}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),c=n.n(s),l=n(103),u=n.n(l),p=n(34),d=n.n(p),m=n(39),f=n.n(m),h=n(212),g=n.n(h),y=n(13),b=(n.n(y),n(67)),v=n(501),_=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),T=function(e){function t(){var e;r(this,t);for(var n=arguments.length,a=Array(n),o=0;o<n;o++)a[o]=arguments[o];var s=i(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(a)));return s.state={open:!1},s.getTranslation=s.context.d2.i18n.getTranslation.bind(s.context.d2.i18n),s.setStartDate=s.setStartDate.bind(s),s.setEndDate=s.setEndDate.bind(s),s.executeAction=s.executeAction.bind(s),s}return o(t,e),_(t,[{key:"componentDidMount",value:function(){var e=this;this.subscriptions=[],this.subscriptions.push(v.a.subscribe(function(t){return e.setState(t)}))}},{key:"componentWillUnmount",value:function(){this.subscriptions.forEach(function(e){return e.unsubscribe&&e.unsubscribe()})}},{key:"requestClose",value:function(){v.a.setState(Object.assign({},v.a.state,{open:!1}))}},{key:"setStartDate",value:function(e,t){var n=new Date(t);this.setState({startDate:n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()})}},{key:"setEndDate",value:function(e,t){var n=new Date(t);this.setState({endDate:n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()})}},{key:"executeAction",value:function(){function e(){return t.apply(this,arguments)}var t=a(regeneratorRuntime.mark(function e(){var t,a,r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.i(y.getInstance)();case 2:t=e.sent,a=[this.state.model.modelDefinition.plural,this.state.model.id,"run"].join("/"),r=a+"?startDate="+this.state.startDate+"&endDate="+this.state.endDate,b.a.show({message:this.getTranslation("predictor_started")}),this.setState({open:!1}),t.Api.getApi().post(r,{startDate:this.state.startDate,endDate:this.state.endDate}).catch(function(e){b.a.show({message:i.getTranslation("failed_to_start_predictor")+": "+e.message,action:"ok"}),console.error(e)});case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"render",value:function(){var e=[c.a.createElement(d.a,{label:this.getTranslation("cancel"),onClick:this.requestClose,style:{marginRight:16}}),c.a.createElement(u.a,{label:this.getTranslation("run_predictor"),primary:!0,onClick:this.executeAction,disabled:!this.state.startDate||!this.state.endDate})];return c.a.createElement(f.a,{open:this.state.open,actions:e,title:this.getTranslation("select_date_range"),contentStyle:{maxWidth:450},bodyStyle:{marginLeft:64}},c.a.createElement(g.a,{autoOk:!0,floatingLabelText:this.getTranslation("start_date")+" (*)",onChange:this.setStartDate}),c.a.createElement(g.a,{autoOk:!0,floatingLabelText:this.getTranslation("end_date")+" (*)",onChange:this.setEndDate}),c.a.createElement("div",{style:{marginBottom:16}}))}}]),t}(c.a.Component);T.contextTypes={d2:c.a.PropTypes.any},t.a=T},1423:function(e,t,n){"use strict";var a=n(14),r=(n.n(a),n(15)),i=n.n(r),o={getInitialState:function(){return this.events={},this.eventSubjects={},{}},createEventObserver:function(){var e=new Map;return function(t){var n=void 0;return e.has(t)?n=e.get(t):(n=new a.Subject,e.set(t,n)),this.events[t]||(this.events[t]=n.map(function(e){return Object.assign({},e)})),function(e){n.next(e)}}}(),componentWillUnmount:function(){var e=this;Object.keys(this.eventSubjects).forEach(function(t){i.a.debug("Completing: "+[e.constructor.name,t].join(".")),e.eventSubjects[t].completed()})}};t.a=o},1425:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(13);n.n(i);i.config.i18n.strings.add("created_by"),i.config.i18n.strings.add("no_author");var o=function(e,t){var n=e.user,a=n&&n.name?t.d2.i18n.getTranslation("created_by")+": "+n.name:t.d2.i18n.getTranslation("no_author");return r.a.createElement("div",null,a)};o.propTypes={user:a.PropTypes.shape({name:a.PropTypes.string}).isRequired},o.contextTypes={d2:a.PropTypes.object.isRequired},t.a=o},1426:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(13),o=(n.n(i),n(1369));i.config.i18n.strings.add("external_access"),i.config.i18n.strings.add("anyone_can_view_without_a_login"),i.config.i18n.strings.add("no_access");var s=function(e,t){var n=e.canView,a=e.disabled,i=e.onChange;return r.a.createElement(o.a,{accessType:"external",disabled:a,disableWritePermission:!0,primaryText:t.d2.i18n.getTranslation("external_access"),secondaryText:n?t.d2.i18n.getTranslation("anyone_can_view_without_a_login"):t.d2.i18n.getTranslation("no_access"),onChange:i,accessOptions:{canView:n}})};s.propTypes={canView:a.PropTypes.bool.isRequired,onChange:a.PropTypes.func.isRequired,disabled:a.PropTypes.bool},s.contextTypes={d2:a.PropTypes.object.isRequired},t.a=s},1427:function(e,t,n){"use strict";function a(e,t,n){return e?t?n.d2.i18n.getTranslation("anyone_can_find_view_and_edit"):n.d2.i18n.getTranslation("anyone_can_find_and_view"):"No access"}var r=n(0),i=n.n(r),o=n(13),s=(n.n(o),n(1369));o.config.i18n.strings.add("public_access"),o.config.i18n.strings.add("anyone_can_find_and_view"),o.config.i18n.strings.add("anyone_can_find_view_and_edit");var c=function(e,t){var n=e.canView,r=e.canEdit,o=e.disabled,c=e.onChange;return i.a.createElement(s.a,{accessType:"public",disabled:o,primaryText:t.d2.i18n.getTranslation("public_access"),secondaryText:a(n,r,t),onChange:c,accessOptions:{canView:n,canEdit:r}})};c.propTypes={canView:r.PropTypes.bool.isRequired,canEdit:r.PropTypes.bool.isRequired,onChange:r.PropTypes.func.isRequired,disabled:r.PropTypes.bool},c.contextTypes={d2:r.PropTypes.object.isRequired},t.a=c},1428:function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=n(0),c=n.n(s),l=n(13),u=(n.n(l),n(157)),p=n.n(u),d=n(313),m=n.n(d),f=n(150),h=n(1431),g=n(1425),y=n(1427),b=n(1426),v=n(1430),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();l.config.i18n.strings.add("who_has_access");var S={createdBy:{color:"#818181"},titleBodySpace:{paddingTop:50},rules:{height:"240px",overflowY:"scroll"}},E=function(e){function t(e){r(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setAccessListRef=function(e){n.accessList=e},n.publicAccessChanged=function(e){var t=e.canView,a=e.canEdit;n.props.onSharingChanged({publicCanView:t,publicCanEdit:a})},n.externalAccessChanged=function(e){var t=e.canView;n.props.onSharingChanged({isSharedExternally:t})},n.accessRulesChanged=function(e,t,r){var i=[].concat(a(n.props.accesses)).map(function(n){return n.id===e?_({},n,{canView:t,canEdit:r}):n});n.props.onSharingChanged({accesses:i})},n.addUserGroupAccess=function(e){var t=[].concat(a(n.props.accesses),[e]);n.props.onSharingChanged({accesses:t},function(){n.scrollAccessListToBottom()})},n.removeUserGroupAccess=function(e){var t=[].concat(a(n.props.accesses)).filter(function(t){return t.id!==e});n.props.onSharingChanged({accesses:t})},n.scrollAccessListToBottom=function(){n.accessList.scrollTop=n.accessList.scrollHeight},n.accessList=null,n}return o(t,e),T(t,[{key:"render",value:function(){var e=this;return c.a.createElement("div",null,c.a.createElement(f.a,{text:this.props.nameOfSharableItem,level:2}),c.a.createElement(g.a,{user:this.props.authorOfSharableItem}),c.a.createElement("div",{style:S.titleBodySpace}),c.a.createElement(m.a,null,this.context.d2.i18n.getTranslation("who_has_access")),c.a.createElement(p.a,null),c.a.createElement("div",{style:S.rules,ref:this.setAccessListRef},c.a.createElement(y.a,{canView:this.props.publicCanView,canEdit:this.props.publicCanEdit,disabled:!this.props.canSetPublicAccess,onChange:this.publicAccessChanged}),c.a.createElement(p.a,null),c.a.createElement(b.a,{canView:this.props.isSharedExternally,disabled:!this.props.canSetExternalAccess,onChange:this.externalAccessChanged}),c.a.createElement(p.a,null),this.props.accesses.map(function(t,n){return c.a.createElement("div",{key:n},c.a.createElement(v.a,{nameOfGroup:t.displayName,groupType:t.type,canView:t.canView,canEdit:t.canEdit,onRemove:function(){e.removeUserGroupAccess(t.id)},onChange:function(n){e.accessRulesChanged(t.id,n.canView,n.canEdit)}}),c.a.createElement(p.a,null))})),c.a.createElement(p.a,null),c.a.createElement(h.a,{onSearch:this.props.onSearch,addUserGroupAccess:this.addUserGroupAccess,currentAccesses:this.props.accesses}))}}]),t}(c.a.Component);E.propTypes={authorOfSharableItem:s.PropTypes.shape({id:s.PropTypes.string,name:s.PropTypes.string}).isRequired,nameOfSharableItem:s.PropTypes.string.isRequired,canSetPublicAccess:s.PropTypes.bool.isRequired,canSetExternalAccess:s.PropTypes.bool.isRequired,publicCanView:s.PropTypes.bool.isRequired,publicCanEdit:s.PropTypes.bool.isRequired,isSharedExternally:s.PropTypes.bool.isRequired,accesses:s.PropTypes.arrayOf(s.PropTypes.shape({type:s.PropTypes.oneOf(["user","userGroup"]).isRequired,id:s.PropTypes.string.isRequired,name:s.PropTypes.string.isRequired,canView:s.PropTypes.bool.isRequired,canEdit:s.PropTypes.bool.isRequired})).isRequired,onSharingChanged:s.PropTypes.func.isRequired,onSearch:s.PropTypes.func.isRequired},E.contextTypes={d2:s.PropTypes.object.isRequired},t.a=E},1429:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e,t){return e?t?"rw------":"r-------":"--------"}function s(e,t){return{id:e.id,name:e.name,displayName:e.displayName,type:t,canView:e.access&&e.access.includes("r"),canEdit:e.access&&e.access.includes("rw")}}function c(e,t){var n=t.userGroupAccesses?t.userGroupAccesses.map(function(e){return s(e,"userGroup")}):[],a=t.userAccesses?t.userAccesses.map(function(e){return s(e,"user")}):[],r=n.concat(a);return{authorOfSharableItem:t.user&&{id:t.user.id,name:t.user.name},nameOfSharableItem:t.name,canSetPublicAccess:e.allowPublicAccess,canSetExternalAccess:e.allowExternalAccess,publicCanView:t.publicAccess.includes("r"),publicCanEdit:t.publicAccess.includes("rw"),isSharedExternally:t.externalAccess,accesses:r}}var l=n(13),u=(n.n(l),n(292)),p=n.n(u),d=n(68),m=n.n(d),f=n(307),h=n.n(f),g=n(0),y=n.n(g),b=n(1428),v=n(502),_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},T=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();l.config.i18n.strings.add("share"),l.config.i18n.strings.add("close"),l.config.i18n.strings.add("no_manage_access");var S=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onSearchRequest=function(e){return n.state.api.get("sharing/search",{key:e}).then(function(e){return e.users.map(function(e){return s(e,"user")}).concat(e.userGroups.map(function(e){return s(e,"userGroup")}))})},n.onSharingChanged=function(e,t){var a=_({},n.state.objectToShare,e),r=n.restoreObjectStructure(a);return n.state.api.post("sharing?type="+n.props.type+"&id="+n.props.id,r).then(function(e){var i=e.httpStatus,o=e.message;return"OK"===i?n.setState({objectToShare:a,apiObject:r},function(){t&&t()}):(console.warn("Failed to post changes."),console.warn("SERVER SAID:",o)),o}).catch(function(e){var t=e.message;console.warn("Failed to post changes."),console.warn("SERVER SAID:",t)})},n.closeSharingDialog=function(){n.props.onRequestClose(n.state.apiObject.object)},n.state={accessForbidden:!1,apiObject:null,objectToShare:null},n.props.open&&n.loadObjectFromApi(),n}return i(t,e),T(t,[{key:"componentWillReceiveProps",value:function(e){e.id!==this.props.id&&(this.setState({accessForbidden:!1,objectToShare:null}),e.open&&this.loadObjectFromApi()),!this.props.open&&e.open&&this.loadObjectFromApi()}},{key:"loadObjectFromApi",value:function(){var e=this;n.i(l.getInstance)().then(function(t){var n=t.Api.getApi();n.get("sharing",{type:e.props.type,id:e.props.id}).then(function(t){e.setState({api:n,apiObject:t,objectToShare:c(t.meta,t.object)})}).catch(function(){e.setState({accessForbidden:!0})})})}},{key:"restoreObjectStructure",value:function(e){var t=[],n=[];return e.accesses.forEach(function(e){var a={id:e.id,name:e.name,displayName:e.name,access:o(e.canView,e.canEdit)};"user"===e.type?t.push(a):n.push(a)}),{meta:this.state.apiObject.meta,object:_({},this.state.apiObject.object,{userAccesses:t,userGroupAccesses:n,publicAccess:o(e.publicCanView,e.publicCanEdit),externalAccess:e.isSharedExternally})}}},{key:"render",value:function(){var e=[y.a.createElement(m.a,{label:this.context.d2.i18n.getTranslation("close"),onClick:this.closeSharingDialog})],t={position:"relative"};return this.state.objectToShare?y.a.createElement(p.a,_({open:this.props.open,title:this.context.d2.i18n.getTranslation("share"),actions:e,autoDetectWindowHeight:!0,autoScrollBodyContent:!0,onRequestClose:this.closeSharingDialog},this.props),y.a.createElement(b.a,{authorOfSharableItem:this.state.objectToShare.authorOfSharableItem,nameOfSharableItem:this.state.objectToShare.nameOfSharableItem,canSetPublicAccess:this.state.objectToShare.canSetPublicAccess,canSetExternalAccess:this.state.objectToShare.canSetExternalAccess,publicCanView:this.state.objectToShare.publicCanView,publicCanEdit:this.state.objectToShare.publicCanEdit,isSharedExternally:this.state.objectToShare.isSharedExternally,accesses:this.state.objectToShare.accesses,onSharingChanged:this.onSharingChanged,onSearch:this.onSearchRequest})):this.state.accessForbidden?y.a.createElement(h.a,{open:!0,message:this.context.d2.i18n.getTranslation("no_manage_access"),autoHideDuration:3e3}):this.props.open?y.a.createElement(v.a,{style:t,size:1}):null}}]),t}(y.a.Component);S.propTypes={open:g.PropTypes.bool.isRequired,onRequestClose:g.PropTypes.func.isRequired,type:g.PropTypes.string.isRequired,id:g.PropTypes.string.isRequired},S.contextTypes={d2:g.PropTypes.object.isRequired},t.a=S},1430:function(e,t,n){"use strict";var a=n(0),r=n.n(a),i=n(1369),o=function(e){var t=e.nameOfGroup,n=e.groupType,a=e.canView,o=e.canEdit,s=e.onChange,c=e.onRemove;return r.a.createElement(i.a,{disableNoAccess:!0,accessType:n,primaryText:t,onChange:s,onRemove:c,accessOptions:{canView:a,canEdit:o}})};o.propTypes={nameOfGroup:a.PropTypes.string.isRequired,groupType:a.PropTypes.oneOf(["user","userGroup"]),canView:a.PropTypes.bool.isRequired,canEdit:a.PropTypes.bool.isRequired,onChange:a.PropTypes.func.isRequired,onRemove:a.PropTypes.func.isRequired},t.a=o},1431:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=null,a=[];return function(){for(var r=arguments.length,i=Array(r),o=0;o<r;o++)i[o]=arguments[o];return clearTimeout(n),n=setTimeout(function(){var t=e.apply(void 0,i);a.forEach(function(e){return e(t)}),a=[]},t),new Promise(function(e){return a.push(e)})}}var s=n(0),c=n.n(s),l=n(13),u=(n.n(l),n(525)),p=n.n(u),d=n(1375),m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();l.config.i18n.strings.add("add_users_and_user_groups"),l.config.i18n.strings.add("enter_names");var h={container:{fontWeight:"400",marginTop:16,padding:16,backgroundColor:"#F5F5F5",display:"flex",flexDirection:"column",justifyContent:"center"},innerContainer:{display:"flex",flexDirection:"row",flex:1},title:{color:"#818181",paddingBottom:8},searchBox:{backgroundColor:"white",boxShadow:"2px 2px 2px #cccccc",padding:"0px 16px",marginRight:"16px"}},g=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.accessOptionsChanged=function(e){var t=e.canView,a=e.canEdit;n.setState({initialViewAccess:t,initialEditAccess:a})},n.groupWasSelected=function(e,t){if(-1!==t){n.setState({searchText:""});var a=n.state.searchResult[t];n.props.addUserGroupAccess(m({},a,{canView:n.state.initialViewAccess,canEdit:n.state.initialEditAccess}))}},n.handleUpdateInput=function(e){n.setState({searchText:e}),n.debouncedSearch(e)},n.generousFilter=function(){return!0},n.state={initialViewAccess:!0,initialEditAccess:!0,searchText:"",searchResult:[]},n.debouncedSearch=o(n.fetchSearchResult.bind(n),300),n}return i(t,e),f(t,[{key:"fetchSearchResult",value:function(e){var t=this;""===e?this.setState({searchResult:[]}):this.props.onSearch(e).then(function(e){var n=e.filter(function(e){return!t.props.currentAccesses.some(function(t){return t.id===e.id})});t.setState({searchResult:n})})}},{key:"render",value:function(){return c.a.createElement("div",{style:h.container},c.a.createElement("div",{style:h.title},this.context.d2.i18n.getTranslation("add_users_and_user_groups")),c.a.createElement("div",{style:h.innerContainer},c.a.createElement(p.a,{dataSource:this.state.searchResult,dataSourceConfig:{text:"displayName",value:"id"},filter:this.generousFilter,fullWidth:!0,hintText:this.context.d2.i18n.getTranslation("enter_names"),onNewRequest:this.groupWasSelected,onUpdateInput:this.handleUpdateInput,openOnFocus:!0,searchText:this.state.searchText,style:h.searchBox,underlineShow:!1}),c.a.createElement(d.a,{disableNoAccess:!0,onChange:this.accessOptionsChanged,accessOptions:{canView:this.state.initialViewAccess,canEdit:this.state.initialEditAccess}})))}}]),t}(s.Component);g.propTypes={onSearch:s.PropTypes.func.isRequired,addUserGroupAccess:s.PropTypes.func.isRequired,currentAccesses:s.PropTypes.array.isRequired},g.contextTypes={d2:s.PropTypes.object.isRequired},t.a=g},1449:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),i=a(r),o=n(19),s=a(o),c=n(20),l=a(c),u=function(e){return i.default.createElement(l.default,e,i.default.createElement("path",{d:"M19 13H5v-2h14v2z"}))};u=(0,s.default)(u),u.displayName="ContentRemove",u.muiName="SvgIcon",t.default=u}});
//# sourceMappingURL=3-7b4b72284bb16785357b.js.map